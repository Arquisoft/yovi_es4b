ifndef::imagesdir[]
:imagesdir: ../images
endif::imagesdir[]

[[section-context-and-scope]]
== Context and Scope
This section describes the system boundary: the communication partners (users and external systems),
the domain-level inputs and outputs, and the technical channels used for interaction. It separates
business context (who interacts with the system and what domain information is exchanged) from
technical context (protocols, ports, and runtime deployment aspects).

Motivation: clear context and scope prevent misunderstandings about responsibilities, interfaces,
and deployment requirements.
=== Business Context

[plantuml, target=business-context-diagram, format=png]
----
@startuml
title Business Context Diagram

actor Administrator
actor Player
actor Bot

package "Docker Compose Environment" {
    node "Gateway (ngnix)" as Gateway
    node "webapp\n(React + Vite + TS)" as WebApp
    node "users\n(Node.js + Express)" as Users
    node "gamey\n(Rust Engine + Bot Service)" as Gamey
    database "Base de Datos de Usuarios \n(Autenticación)" as UserDB
    database "Base de Datos de Partidas" as GameDB
}

' Relaciones de actores
Player --> Gateway : Access via web-browser\nPlay games\nView stats
Gateway --> WebApp : FrontEnd
Administrator --> Users : User management\nSystem monitoring
Bot --> Gamey : View user stats\nPlay games

' Internal services interactions
Gateway --> Users : Authentication\n User management
Gateway --> Gamey : Request games\nCheck game status
Users --> UserDB : User authetication
Gamey --> GameDB : Save games\nQuery statistics
@enduml
----

=== Elements Description
* **Player**: The end-user who interacts with the system through a web browser to play games and view statistics.
* **Administrator**: Responsible for managing users and monitoring the system.
* **Bot**: An automated agent that can interact with the game engine to play games and view user stats.
* **WebApp**: The front-end application built with React and Vite, serving the user interface and handling user interactions.
* **Users**: The back-end service responsible for user authentication and management, built with Node.js.
* **Gamey**: The game engine and bot service implemented in Rust, responsible for game logic and interactions with bots.
* **DB**: The database used to persist user data and games.




ifdef::arc42help[]
[role="arc42help"]
****
.Contents
Specification of *all* communication partners (users, IT-systems, ...) with explanations of domain specific inputs and outputs or interfaces.

.Motivation
All stakeholders should understand which data are exchanged with the environment of the system.

.Form
All kinds of diagrams that show the system as a black box and specify the domain interfaces to communication partners.

The title of the table is the name of your system, the three columns contain the name of the communication partner, the inputs, and the outputs.

****
endif::arc42help[]


=== Technical Context
[plantuml, target=technical-context-diagram, format=png]
----
@startuml
title Technical Context - Deployment & Interfaces

actor "Player (Browser)" as Browser
actor "Administrator" as Admin
actor "External Bot" as ExternalBot

package "Docker Compose Environment" {

    node "Gateway\n(nginx)\nports: 80/443" as Gateway
    node "WebApp\n(React + Vite + TypeScript)\nports: 80 (prod) / 5173 (dev)" as WebApp
    node "Users\n(Node.js + Express)\nport: 3000" as Users
    node "Gamey\n(Rust engine + Bot service)\nport: 4000" as Gamey

    database "User Authentication DB\n(MongoDB)\nport: 27017" as UserDB
    database "Game Stats DB\n(MongoDB)\nport: 27017" as GameDB

    node "Prometheus\nSystem Monitoring\nport: 9090" as Prometheus
    node "Grafana\nDashboards\nhost port: 9091" as Grafana
}

' --- External interactions ---
Browser --> Gateway : HTTPS (443) / HTTP (80)
Browser --> WebApp : HTTP (dev 5173)
Admin --> Users : HTTPS (3000) - admin API
ExternalBot --> Gamey : HTTPS JSON (4000) - bot API

' --- Internal service communication ---
Gateway --> WebApp : HTTP (internal)
Gateway --> Users : HTTP JSON (REST)
Gateway --> Gamey : HTTP JSON (REST)
Users --> UserDB : TCP (DB driver)
Gamey --> GameDB : TCP (DB driver)

' --- Monitoring ---
Users --> Prometheus : HTTP /metrics
Gamey --> Prometheus : HTTP /metrics
Prometheus --> Grafana : HTTP (data source)

note left of UserDB
DB runs in a container with a mounted persistent volume.
end note

note bottom of Gateway
Internal Docker network; only expose the Gateway in production.
end note

@enduml
----

==== Elements Description



ifdef::arc42help[]
[role="arc42help"]
****
.Contents
Technical interfaces (channels and transmission media) linking the system to its environment. In addition a mapping of domain specific input/output to the channels, i.e. an explanation which I/O uses which channel.

.Motivation
Many stakeholders make architectural decision based on the technical interfaces between the system and its context. Especially infrastructure or hardware designers decide these technical interfaces.

.Form
E.g. UML deployment diagram describing channels to neighboring systems,
together with a mapping table showing the relationships between channels and input/output.

****
endif::arc42help[]

|===
| Participants        | Input/Output                                            | Channel/Protocol

| Player (Browser)
| Web navigation, gameplay actions, requests to the frontend
| HTTPS (via Reverse Proxy) / HTTP (dev 5173)

| Administrator
| Administration actions, user management requests
| HTTPS (Users API)

| External Bot
| Game actions, statistics queries, automated gameplay
| HTTPS JSON (Gamey API)

| Reverse Proxy (nginx)
| Incoming HTTP/HTTPS traffic, routing to internal services
| HTTPS externally / HTTP internally

| WebApp (React + Vite + TypeScript)
| User interactions, REST API calls to Users and Gamey
| HTTP (internal REST)

| Users (Node.js + Express)
| Authentication, user management, metrics endpoint
| HTTP (internal REST) / TCP (database driver)

| Gamey (Rust Engine + Bot Service)
| Game logic, bot API, metrics endpoint
| HTTP (internal REST) / TCP (database driver)

| Database (Postgres / Mongo)
| Storage of users, game sessions, statistics
| SQL/NoSQL over TCP

| Prometheus
| Metrics scraping from Users and Gamey
| HTTP (/metrics)

| Grafana
| Dashboard visualization, queries to Prometheus
| HTTP (host port 9091 → container port 3000)

|===

